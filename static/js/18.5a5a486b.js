(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"0cf0":function(t,e,i){"use strict";var n=i("e7e7"),s=i.n(n);s.a},"242f":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"m_reservation"},[i("van-cell-group",{staticClass:"input_cell"},[i("van-field",{attrs:{readonly:!0,"input-align":"right",required:"",clearable:"",label:"预订日期"},on:{click:t.showDate},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date","string"===typeof e?e.trim():e)},expression:"form.date"}},[i("div",{attrs:{slot:"button"},on:{click:t.showDate},slot:"button"},[i("div",{staticClass:"triangle"},[i("div",{staticClass:"t_content"})])])]),i("van-field",{attrs:{readonly:!0,"input-align":"right",required:"",clearable:"",label:"选择时间段"},on:{click:t.showTimes},model:{value:t.form.times,callback:function(e){t.$set(t.form,"times","string"===typeof e?e.trim():e)},expression:"form.times"}},[i("div",{attrs:{slot:"button"},on:{click:t.showTimes},slot:"button"},[i("div",{staticClass:"triangle"},[i("div",{staticClass:"t_content"})])])]),i("div",{staticClass:"split_title"},[t._v("预订事由")]),i("van-field",{attrs:{required:"",type:"textarea",rows:"6",placeholder:"请填写预订的理由"},model:{value:t.form.reason,callback:function(e){t.$set(t.form,"reason",e)},expression:"form.reason"}}),i("div",{staticClass:"split_title"},[t._v("预订人信息")]),t.columns.length>1?i("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"公司名称"},model:{value:t.form.companyname,callback:function(e){t.$set(t.form,"companyname","string"===typeof e?e.trim():e)},expression:"form.companyname"}},[i("div",{attrs:{slot:"button"},on:{click:t.selCompany},slot:"button"},[i("div",{staticClass:"triangle"},[i("div",{staticClass:"t_content"})])])]):t._e(),t.columns.length<=1?i("van-field",{attrs:{disabled:1==t.columns.length,"input-align":"right",required:"",clearable:"",label:"公司名称"},model:{value:t.form.companyname,callback:function(e){t.$set(t.form,"companyname","string"===typeof e?e.trim():e)},expression:"form.companyname"}}):t._e(),i("van-field",{attrs:{"input-align":"right",required:"",clearable:"",disabled:t.form.username,label:"预订人姓名"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username","string"===typeof e?e.trim():e)},expression:"form.username"}}),i("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"预订人电话"},model:{value:t.form.userphone,callback:function(e){t.$set(t.form,"userphone","string"===typeof e?e.trim():e)},expression:"form.userphone"}}),i("van-field",{attrs:{type:"number","input-align":"right",required:"",clearable:"",label:"参会人数"},model:{value:t.form.user_count,callback:function(e){t.$set(t.form,"user_count","string"===typeof e?e.trim():e)},expression:"form.user_count"}}),i("div",{staticClass:"split_title"},[t._v("增值服务")]),t._l(t.list,function(e,n){return t.list.length?i("div",{key:n,staticClass:"other_line"},[t._v("\n                "+t._s(e.name)+"\n                "),i("div",{staticClass:"line_right"},[i("span",[t._v(t._s(e.price)+"元/"+t._s(e.unit))]),t._v("  \n                    "),i("a",{staticClass:"sub-count",attrs:{href:"javascript:"},on:{click:function(i){t.doMinus(e,n)}}},[t._v("-")]),i("span",{staticClass:"count_width"},[t._v(" "+t._s(e.count))]),i("a",{staticClass:"sub-count",attrs:{href:"javascript:"},on:{click:function(i){t.doAdd(e,n)}}},[t._v("+")])])]):t._e()}),i("div",{staticClass:"split_title sub_font"},[t._v("提醒：会议室费用线下支付，请提交订单后及时联系会议室管理人员。联系电话("),i("a",{staticStyle:{color:"blue"},attrs:{href:"tel://15099909769"}},[t._v("15099909769")]),t._v("）")])],2),i("div",{staticClass:"fix_bottom"},[i("div",{staticClass:"res_btn",on:{click:function(e){t.doSubmit()}}},[t._v("\n       预计费用￥"+t._s(t.allPrice)+"  提交\n    ")])]),i("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("van-datetime-picker",{attrs:{type:"date","min-date":t.minDate},on:{confirm:t.confirmDate,cancel:t.onCancel},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:t.show3,callback:function(e){t.show3=e},expression:"show3"}},[i("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{confirm:t.onConfirm3,cancel:t.onCancel}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:t.show2,callback:function(e){t.show2=e},expression:"show2"}},[i("div",{staticClass:"van-picker"},[i("div",{staticClass:"van-hairline--top-bottom van-picker__toolbar"},[i("div",{staticClass:"van-picker__cancel",on:{click:t.onCancel}},[t._v("取消")]),i("div",{staticClass:"van-picker__confirm",on:{click:t.onConfirm}},[t._v("确认")])]),i("div",{staticClass:"van-picker__columns",staticStyle:{height:"380px"}},[i("div",{staticClass:"van-picker-column",staticStyle:{height:"420px"}},[i("ul",{staticClass:"times_ul"},t._l(t.data.timeSetting,function(e,n){return i("li",{key:n,class:{over:!e.over,noSel:!e.status,active:e.id>=t.range[0]&&e.id<=t.range[1]},on:{click:function(i){t.doSelect(e)}}},[t._v(t._s(e.begin_time)+" - "+t._s(e.end_time))])}))])])])])],1)},s=[],a=(i("28a5"),i("7f7f"),i("ac6a"),{name:"m_reservation",data:function(){return{id:this.$route.params.mid||1,form:{date:"",times:"",reason:"",companyname:"",username:"",userphone:"",user_count:"",meeting_service:[],price:""},data:{},currentDate:new Date,minDate:new Date,show:!1,show2:!1,show3:!1,nowDate:this.formatDate(new Date),range:[],rangeOrigin:[],list:[]}},created:function(){this.getData(),this.getUser(),this.getIncr()},watch:{"form.date":function(){var t=this;this.rangeOrigin=[],this.form.times="",this.data.timeSetting.forEach(function(e,i){if(e.over=1,t.form.date==t.nowDate){var n=t.ChangeStrToMinutes(e.begin_time),s=new Date,a=s.getHours()+":"+s.getMinutes(),o=t.ChangeStrToMinutes(a);n<o&&(e.over=0)}})}},computed:{allPrice:function(){var t=0;return this.list.forEach(function(e,i){t+=e.count*e.price}),this.rangeOrigin.length&&(t+=400*(this.rangeOrigin[1]-this.rangeOrigin[0]+1)),t}},methods:{showDate:function(){this.show=!0},confirmDate:function(){this.form.date=this.formatDate(this.currentDate),this.show=!1},showTimes:function(){""!=this.form.date?(this.range=JSON.parse(JSON.stringify(this.rangeOrigin)),this.show2=!0):this.$toast({message:"请先选择日期",duration:1e3})},selCompany:function(){this.show3=!0},onConfirm3:function(t,e,i){this.form.companyname=t,this.show3=!1},onCancel:function(){this.show=!1,this.show3=!1,this.show2=!1},onConfirm:function(){var t=this;this.rangeOrigin=JSON.parse(JSON.stringify(this.range)),2==this.rangeOrigin.length?this.data.timeSetting.forEach(function(e,i){e.id==t.rangeOrigin[0]&&(t.form.times=e.begin_time),e.id==t.rangeOrigin[1]&&(t.form.times+="-"+e.end_time)}):(this.$toast({message:"请选择时间段",duration:1e3}),this.form.times=""),this.show2=!1},doSelect:function(t){if(0!=t.over){if(0==this.range.length)return this.range.push(t.id),void this.range.push(t.id);if(console.log(t.id,this.range),2==this.range.length){if(t.id==this.range[0]&&t.id==this.range[1])return void(this.range=[]);if(t.id==this.range[1])return void this.$set(this.range,1,parseInt(t.id)-1);(t.id>=this.range[0]||t.id>this.range[1])&&this.$set(this.range,1,t.id),t.id<this.range[0]&&this.$set(this.range,0,t.id)}}},getData:function(){var t=this;this.axios.get("/app/meeting/applyDetail?id="+this.id).then(function(e){1==e.s&&(t.data=e.d)})},getIncr:function(){var t=this;this.axios.get("/app/meeting/getIncr").then(function(e){1==e.s&&(t.list=e.d,t.list.length&&t.list.forEach(function(e,i){t.$set(t.list,i,{price:e.price,unit:e.unit,name:e.name,id:e.id,count:0})}))})},getUser:function(){if(sessionStorage.users){var t=JSON.parse(sessionStorage.users);this.form.username=t.name,this.form.userphone=t.phone,this.form.companyname=t.company[0]||"",this.columns=JSON.parse(JSON.stringify(t.company))}},formatDate:function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1;n<10&&(n="0"+n);var s=e.getDate();return s<10&&(s="0"+s),i+"-"+n+"-"+s},ChangeStrToMinutes:function(t){var e=t.split(":");if(2==e.length){var i=60*parseInt(e[0])+parseInt(e[1]);return i}return 0},doMinus:function(t){0!=t.count&&t.count--},doAdd:function(t,e){t.count=t.count+1},doSubmit:function(){var t=this;""!=this.form.times?""!=this.form.reason?""!=this.form.companyname?""!=this.form.username?""!=this.form.userphone?""!=this.form.user_count?(this.form.meeting_service=this.list,this.form.price=this.allPrice,this.form.id=this.id,this.$dialog.confirm({title:"确认预订?",message:"提醒：会议室费用线下支付，请提交订单后及时联系会议室管理人员。联系电话(15099909769）"}).then(function(){t.axios.post("/app/meeting/reserveRoom",t.form).then(function(e){1==e.s&&(t.data=e.d,t.$toast("提交成功!2秒后返回订单页..."),setTimeout(function(){t.$router.push({path:"/"})},2e3))})}).catch(function(){})):this.$toast({message:"请填写参会人数",duration:1e3}):this.$toast({message:"请填写预订人电话",duration:1e3}):this.$toast({message:"请填写预订人姓名",duration:1e3}):this.$toast({message:"请填写公司名称",duration:1e3}):this.$toast({message:"请填写预订理由",duration:1e3}):this.$toast({message:"请选择时间",duration:1e3})}}}),o=a,r=(i("0cf0"),i("2877")),c=Object(r["a"])(o,n,s,!1,null,"5f5f6856",null);c.options.__file="Reservation.vue";e["default"]=c.exports},"28a5":function(t,e,i){i("214f")("split",2,function(t,e,n){"use strict";var s=i("aae3"),a=n,o=[].push,r="split",c="length",l="lastIndex";if("c"=="abbc"[r](/(b)*/)[1]||4!="test"[r](/(?:)/,-1)[c]||2!="ab"[r](/(?:ab)*/)[c]||4!="."[r](/(.?)(.?)/)[c]||"."[r](/()()/)[c]>1||""[r](/.?/)[c]){var u=void 0===/()??/.exec("")[1];n=function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!s(t))return a.call(i,t,e);var n,r,m,h,f,d=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),g=0,v=void 0===e?4294967295:e>>>0,_=new RegExp(t.source,p+"g");u||(n=new RegExp("^"+_.source+"$(?!\\s)",p));while(r=_.exec(i)){if(m=r.index+r[0][c],m>g&&(d.push(i.slice(g,r.index)),!u&&r[c]>1&&r[0].replace(n,function(){for(f=1;f<arguments[c]-2;f++)void 0===arguments[f]&&(r[f]=void 0)}),r[c]>1&&r.index<i[c]&&o.apply(d,r.slice(1)),h=r[0][c],g=m,d[c]>=v))break;_[l]===r.index&&_[l]++}return g===i[c]?!h&&_.test("")||d.push(""):d.push(i.slice(g)),d[c]>v?d.slice(0,v):d}}else"0"[r](void 0,0)[c]&&(n=function(t,e){return void 0===t&&0===e?[]:a.call(this,t,e)});return[function(i,s){var a=t(this),o=void 0==i?void 0:i[e];return void 0!==o?o.call(i,a,s):n.call(String(a),i,s)},n]})},"7f7f":function(t,e,i){var n=i("86cc").f,s=Function.prototype,a=/^\s*function ([^ (]*)/,o="name";o in s||i("9e1e")&&n(s,o,{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},e7e7:function(t,e,i){}}]);
//# sourceMappingURL=18.5a5a486b.js.map